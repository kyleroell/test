<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Loading and Manipulating GEO Data | GEO Data Tutorial</title>
  <meta name="description" content="This is tutorial for how to download and use GEO datasets." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Loading and Manipulating GEO Data | GEO Data Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is tutorial for how to download and use GEO datasets." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Loading and Manipulating GEO Data | GEO Data Tutorial" />
  
  <meta name="twitter:description" content="This is tutorial for how to download and use GEO datasets." />
  

<meta name="author" content="Kyle Roell" />


<meta name="date" content="2021-06-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="statistical-procedures.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GEO Data Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Gene Expression Omnibus (GEO)</a></li>
<li class="chapter" data-level="2" data-path="geoquery.html"><a href="geoquery.html"><i class="fa fa-check"></i><b>2</b> Loading and Manipulating GEO Data</a></li>
<li class="chapter" data-level="3" data-path="statistical-procedures.html"><a href="statistical-procedures.html"><i class="fa fa-check"></i><b>3</b> Statistical Procedures</a><ul>
<li class="chapter" data-level="3.1" data-path="statistical-procedures.html"><a href="statistical-procedures.html#t-test"><i class="fa fa-check"></i><b>3.1</b> T-Test</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="heatmap.html"><a href="heatmap.html"><i class="fa fa-check"></i><b>4</b> Heatmap</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO Data Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geoquery" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Loading and Manipulating GEO Data</h1>
<p>The <a href="https://www.bioconductor.org/packages/release/bioc/html/GEOquery.html">GEOquery package</a> allows for easy reading in and downloading data from GEO. This will parse the data for you and store it into an R object that you can reference and manipulate for data analysis.</p>
<p>You can both read in data from a file that has manually been downloaded from GEO or let GEOquery download the data for you. Here, we will show how to simply read in a file that we have already downloaded from GEO. All we need to download is the same file that we manipulated in Method 1 above!</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="geoquery.html#cb1-1"></a><span class="co">#First install GEOquery</span></span>
<span id="cb1-2"><a href="geoquery.html#cb1-2"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb1-3"><a href="geoquery.html#cb1-3"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>);</span>
<span id="cb1-4"><a href="geoquery.html#cb1-4"></a></span>
<span id="cb1-5"><a href="geoquery.html#cb1-5"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;GEOquery&quot;</span>);</span>
<span id="cb1-6"><a href="geoquery.html#cb1-6"></a></span>
<span id="cb1-7"><a href="geoquery.html#cb1-7"></a><span class="co">#load the package</span></span>
<span id="cb1-8"><a href="geoquery.html#cb1-8"></a><span class="kw">library</span>(GEOquery);</span>
<span id="cb1-9"><a href="geoquery.html#cb1-9"></a></span>
<span id="cb1-10"><a href="geoquery.html#cb1-10"></a><span class="co">#Now we can use the getGEO function to load data from our series matrix</span></span>
<span id="cb1-11"><a href="geoquery.html#cb1-11"></a>geo.getGEO.data =<span class="st"> </span><span class="kw">getGEO</span>(<span class="dt">filename=</span><span class="st">&#39;~/Downloads/GSE42394_series_matrix.txt&#39;</span>);</span>
<span id="cb1-12"><a href="geoquery.html#cb1-12"></a></span>
<span id="cb1-13"><a href="geoquery.html#cb1-13"></a><span class="co">#We can get a dataset with the sample information using the pData() function</span></span>
<span id="cb1-14"><a href="geoquery.html#cb1-14"></a>sampleInfo &lt;-<span class="st"> </span><span class="kw">pData</span>(geo.getGEO.data);</span>
<span id="cb1-15"><a href="geoquery.html#cb1-15"></a></span>
<span id="cb1-16"><a href="geoquery.html#cb1-16"></a><span class="co">#Let&#39;s look at some of our sample information dataset columns</span></span>
<span id="cb1-17"><a href="geoquery.html#cb1-17"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb1-18"><a href="geoquery.html#cb1-18"></a>  <span class="kw">head</span>(sampleInfo[,<span class="kw">c</span>(<span class="st">&quot;geo_accession&quot;</span>, <span class="st">&quot;cell type:ch1&quot;</span>, <span class="st">&quot;time:ch1&quot;</span>,</span>
<span id="cb1-19"><a href="geoquery.html#cb1-19"></a>                     <span class="st">&quot;treatment:ch1&quot;</span>)]), <span class="dt">caption =</span> <span class="st">&#39;Sample information column names&#39;</span>,</span>
<span id="cb1-20"><a href="geoquery.html#cb1-20"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb1-21"><a href="geoquery.html#cb1-21"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:load2">Table 2.1: </span>Sample information column names</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">geo_accession</th>
<th align="left">cell type:ch1</th>
<th align="left">time:ch1</th>
<th align="left">treatment:ch1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GSM1150937</td>
<td align="left">GSM1150937</td>
<td align="left">Nasal epithelial cells</td>
<td align="left">7 day</td>
<td align="left">unexposed</td>
</tr>
<tr class="even">
<td align="left">GSM1150938</td>
<td align="left">GSM1150938</td>
<td align="left">Nasal epithelial cells</td>
<td align="left">7 day</td>
<td align="left">unexposed</td>
</tr>
<tr class="odd">
<td align="left">GSM1150939</td>
<td align="left">GSM1150939</td>
<td align="left">Nasal epithelial cells</td>
<td align="left">7 day</td>
<td align="left">unexposed</td>
</tr>
<tr class="even">
<td align="left">GSM1150940</td>
<td align="left">GSM1150940</td>
<td align="left">Nasal epithelial cells</td>
<td align="left">7 day</td>
<td align="left">2 ppm formaldehyde</td>
</tr>
<tr class="odd">
<td align="left">GSM1150941</td>
<td align="left">GSM1150941</td>
<td align="left">Nasal epithelial cells</td>
<td align="left">7 day</td>
<td align="left">2 ppm formaldehyde</td>
</tr>
<tr class="even">
<td align="left">GSM1150942</td>
<td align="left">GSM1150942</td>
<td align="left">Nasal epithelial cells</td>
<td align="left">7 day</td>
<td align="left">2 ppm formaldehyde</td>
</tr>
</tbody>
</table>
<p>Now, we can use this to just define the samples we want to analyze.</p>
<p>We only want cell type = Nasal epithelial cells and time = 7 day. To do this, we can use our sampleInfo dataset and the variables “cell type:ch1” and “time:ch1”. We will also define treated and untreated using the variable “treatment:ch1”.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="geoquery.html#cb2-1"></a><span class="co">#Define keep variable that will store rows we want to keep</span></span>
<span id="cb2-2"><a href="geoquery.html#cb2-2"></a>keep =<span class="st"> </span><span class="kw">rownames</span>(sampleInfo[<span class="kw">which</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">cell type:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;Nasal epithelial cells&quot;</span> </span>
<span id="cb2-3"><a href="geoquery.html#cb2-3"></a>                                 <span class="op">&amp;</span><span class="st"> </span>sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">time:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;7 day&quot;</span>),]);</span>
<span id="cb2-4"><a href="geoquery.html#cb2-4"></a></span>
<span id="cb2-5"><a href="geoquery.html#cb2-5"></a><span class="co">#first let&#39;s just subset sample info for just those samples we defined in keep variable</span></span>
<span id="cb2-6"><a href="geoquery.html#cb2-6"></a>sampleInfo =<span class="st"> </span>sampleInfo[keep,];</span>
<span id="cb2-7"><a href="geoquery.html#cb2-7"></a></span>
<span id="cb2-8"><a href="geoquery.html#cb2-8"></a><span class="co">#get the treated and untreated sample ids </span></span>
<span id="cb2-9"><a href="geoquery.html#cb2-9"></a><span class="co">#(which are in the variable geo_accession)</span></span>
<span id="cb2-10"><a href="geoquery.html#cb2-10"></a>treated  =<span class="st"> </span>sampleInfo[<span class="kw">which</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">treatment:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;2 ppm formaldehyde&quot;</span>), </span>
<span id="cb2-11"><a href="geoquery.html#cb2-11"></a>                      <span class="st">&quot;geo_accession&quot;</span>];</span>
<span id="cb2-12"><a href="geoquery.html#cb2-12"></a>untreated  =<span class="st"> </span>sampleInfo[<span class="kw">which</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">treatment:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;unexposed&quot;</span>), </span>
<span id="cb2-13"><a href="geoquery.html#cb2-13"></a>                        <span class="st">&quot;geo_accession&quot;</span>];</span></code></pre></div>
<p>We now have a list of the samples we want to keep, stored in our variable “keep”. The next step is to actually get the data we want to use in our analyses. The GEOquery function exprs() allows us to easily get this data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="geoquery.html#cb3-1"></a><span class="co">#We can get the actual data using the exprs() function</span></span>
<span id="cb3-2"><a href="geoquery.html#cb3-2"></a><span class="co">#and we only want to keep those we previously defined</span></span>
<span id="cb3-3"><a href="geoquery.html#cb3-3"></a>ge.data =<span class="st"> </span><span class="kw">exprs</span>(geo.getGEO.data[,keep]);</span>
<span id="cb3-4"><a href="geoquery.html#cb3-4"></a></span>
<span id="cb3-5"><a href="geoquery.html#cb3-5"></a><span class="co">#Let&#39;s look at our sample information dataset</span></span>
<span id="cb3-6"><a href="geoquery.html#cb3-6"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb3-7"><a href="geoquery.html#cb3-7"></a>  ge.data[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">caption =</span> <span class="st">&#39;Gene expression data&#39;</span>,</span>
<span id="cb3-8"><a href="geoquery.html#cb3-8"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb3-9"><a href="geoquery.html#cb3-9"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:load2b">Table 2.2: </span>Gene expression data</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">GSM1150937</th>
<th align="right">GSM1150938</th>
<th align="right">GSM1150939</th>
<th align="right">GSM1150940</th>
<th align="right">GSM1150941</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10700001</td>
<td align="right">5786.60</td>
<td align="right">5830.08</td>
<td align="right">5637.34</td>
<td align="right">5313.33</td>
<td align="right">5557.04</td>
</tr>
<tr class="even">
<td align="left">10700002</td>
<td align="right">192.92</td>
<td align="right">206.86</td>
<td align="right">220.83</td>
<td align="right">183.12</td>
<td align="right">177.16</td>
</tr>
<tr class="odd">
<td align="left">10700003</td>
<td align="right">1820.98</td>
<td align="right">1795.79</td>
<td align="right">1735.70</td>
<td align="right">1578.02</td>
<td align="right">1681.58</td>
</tr>
<tr class="even">
<td align="left">10700004</td>
<td align="right">66.95</td>
<td align="right">65.61</td>
<td align="right">64.41</td>
<td align="right">60.19</td>
<td align="right">60.41</td>
</tr>
<tr class="odd">
<td align="left">10700005</td>
<td align="right">770.07</td>
<td align="right">753.41</td>
<td align="right">731.20</td>
<td align="right">684.53</td>
<td align="right">657.25</td>
</tr>
</tbody>
</table>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-procedures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TestBook.pdf", "TestBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
